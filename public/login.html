<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>LOGIN MILITAR | EB</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-database-compat.js"></script>
    <script src="/firebase-config.js"></script>

    <style>
        /* CSS GLOBAL SINCRONIZADO - PADRÃO DARK DISCORD */
        :root {
            --bg-deep: #1e1f22;
            --bg-card: #2b2d31;
            --eb-ouro: #d4af37;
            --radius-informal: 35px;
            --text-main: #dbdee1;
        }

        body {
            background-color: var(--bg-deep);
            color: var(--text-main);
            font-family: 'gg sans', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            padding: 20px;
        }

        /* CARD REDONDO E PROFISSIONAL */
        .login-card {
            background: var(--bg-card);
            padding: 50px 40px;
            border-radius: var(--radius-informal);
            width: 100%;
            max-width: 420px;
            text-align: center;
            box-shadow: 0 25px 50px rgba(0,0,0,0.5);
            border: 1px solid rgba(255,255,255,0.05);
            animation: fadeIn 0.8s ease;
        }

        .eb-brand { width: 85px; margin-bottom: 25px; }

        .title { font-size: 22px; font-weight: 900; color: #fff; margin-bottom: 10px; }
        .subtitle { font-size: 13px; color: var(--eb-ouro); font-weight: bold; text-transform: uppercase; margin-bottom: 35px; }

        /* INPUTS ESTILIZADOS */
        .input-box {
            background: #111214;
            border: 2px solid transparent;
            border-radius: 20px;
            padding: 18px;
            width: 100%;
            color: #fff;
            font-size: 16px;
            margin-bottom: 20px;
            text-align: center;
            transition: 0.3s;
            outline: none;
        }

        .input-box:focus { border-color: var(--eb-ouro); box-shadow: 0 0 15px rgba(212, 175, 55, 0.2); }

        /* BOTÃO TÁTICO */
        .btn-auth {
            background: var(--eb-ouro);
            color: #000;
            width: 100%;
            padding: 18px;
            border-radius: 20px;
            border: none;
            font-weight: 900;
            cursor: pointer;
            text-transform: uppercase;
            transition: 0.3s;
        }

        .btn-auth:hover { transform: translateY(-3px); box-shadow: 0 10px 20px rgba(212, 175, 55, 0.2); }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

    <div class="login-card">
        <img src="https://i.imgur.com/8Y6E7Gv.png" class="eb-brand" alt="EB">
        <h1 class="title">Área Restrita</h1>
        <p class="subtitle">Autenticação Orbitron</p>

        <input type="password" id="key" class="input-box" placeholder="INSIRA SUA CHAVE ORB">
        <button class="btn-auth" onclick="Auth.login()">ACESSAR TERMINAL</button>
        
        <div id="status" style="margin-top: 20px; font-weight: bold; font-size: 12px;"></div>
    </div>

    <script>
        /** * LÓGICA DE SEGURANÇA INTEGRADA
         * Sincronizada com o módulo de Logs de 1000 linhas
         */
        const Auth = {
            login: async () => {
                const key = document.getElementById('key').value.trim();
                const status = document.getElementById('status');

                if(!key) return;

                status.innerText = "VERIFICANDO...";
                status.style.color = "var(--eb-ouro)";

                try {
                    const snap = await db.ref(`logins_gerados/${key}`).once('value');
                    const user = snap.val();

                    if(user) {
                        localStorage.setItem('militar_chave', key);
                        localStorage.setItem('militar_nome', user.responsavel);
                        status.style.color = "#23a559";
                        status.innerText = "ACESSO PERMITIDO!";
                        
                        // Direcionamento tático baseado no cargo
                        setTimeout(() => {
                            window.location.href = user.cargo === 'dono' ? '/dono.html' : '/admin.html';
                        }, 1500);
                    } else {
                        status.style.color = "#f23f42";
                        status.innerText = "CHAVE INVÁLIDA!";
                        if(typeof enviarLog === 'function') enviarLog("TENTATIVA DE INVASÃO", [{name: "Chave Usada", value: key}], 15105570);
                    }
                } catch (e) {
                    status.innerText = "ERRO DE CONEXÃO.";
                }
            }
        };
    </script>
</body>
</html>
