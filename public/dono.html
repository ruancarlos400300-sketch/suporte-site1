<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>COMANDO SUPREMO</title>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-database-compat.js"></script>
    <script src="/firebase-config.js"></script>
    <style>
        body { background: #1e1f22; color: white; font-family: sans-serif; padding: 50px; }
        .nav-menu { position: fixed; top: 20px; left: 20px; background: #5865f2; padding: 10px 20px; border-radius: 30px; cursor: pointer; z-index: 1000; box-shadow: 0 5px 15px rgba(88,101,242,0.4); }
        .nav-content { display: none; position: absolute; top: 50px; left: 0; background: #2b2d31; border-radius: 12px; width: 200px; padding: 10px; border: 1px solid #3f4147; }
        .nav-menu:hover .nav-content { display: block; }
        .nav-link { display: block; padding: 10px; color: white; text-decoration: none; border-radius: 8px; margin-bottom: 5px; transition: 0.2s; }
        .nav-link:hover { background: #35373c; color: #5865f2; }
        
        .membro-card { background: #2b2d31; padding: 20px; border-radius: 16px; display: inline-block; margin: 10px; border-top: 5px solid #5865f2; animation: scaleIn 0.3s ease; }
        @keyframes scaleIn { from { transform: scale(0.9); opacity: 0; } to { transform: scale(1); opacity: 1; } }
    </style>
</head>
<body>

    <div class="nav-menu">
        ☰ MENU SUPREMO
        <div class="nav-content">
            <a href="/" class="nav-link">Página Player</a>
            <a href="/login" class="nav-link">Página Login</a>
            <a href="/admin" class="nav-link">Página Staff</a>
            <hr style="opacity:0.1; margin:10px 0;">
            <a href="#" onclick="auth.signOut()" class="nav-link" style="color:#ed4245">Deslogar</a>
        </div>
    </div>

    <h1>Oficiais Orbitron</h1>
    <div id="membros"></div>

    <script>
        auth.onAuthStateChanged(user => {
            if(user) {
                db.ref('usuarios/' + user.uid).once('value', snap => {
                    if(snap.val().cargo !== 'dono') window.location.href = '/admin';
                });
            } else { window.location.href = '/login'; }
        });

        db.ref('usuarios').on('value', snap => {
            const div = document.getElementById('membros');
            div.innerHTML = "";
            snap.forEach(m => {
                const u = m.val();
                div.innerHTML += `
                    <div class="membro-card">
                        <h3>${u.nome}</h3>
                        <p style="color:#b5bac1">${u.cargo.toUpperCase()}</p>
                        <h2 style="color:#23a559; margin:10px 0;">${u.pontos.toFixed(1)} PTS</h2>
                        <button onclick="add('${m.key}', 1)">+1 PT</button>
                        <button onclick="add('${m.key}', -1)">-1 PT</button>
                    </div>
                `;
            });
        });

        function add(uid, v) {
            db.ref('usuarios/' + uid + '/pontos').transaction(p => (p || 0) + v);
        }
    </script>
</body>
</html>
